<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Lab 8 - CI / CD Pipeline | Red Hat | Public Sector</title>

    
    
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly.min.css" />
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly-additions.min.css" />

    
    <link rel="stylesheet" href="/node_modules/highlight.js/styles/darkula.css" />

    
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/asciidoc.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <link rel="stylesheet" href="/css/toastr.min.css" />

    
    <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery/dist/jquery.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/c3/c3.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/d3/d3.min.js"></script>

    
    
    <script src="/node_modules/patternfly/node_modules/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/drmonty-datatables-colvis/js/dataTables.colVis.js"></script>
    <script src="/node_modules/patternfly/node_modules/datatables.net-colreorder/js/dataTables.colReorder.js"></script>

    
    
    <script src="/node_modules/patternfly/dist/js/patternfly.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-combobox/js/bootstrap-combobox.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/moment/min/moment.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-select/dist/js/bootstrap-select.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-switch/dist/js/bootstrap-switch.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-treeview/dist/bootstrap-treeview.min.js"></script>

    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery-match-height/dist/jquery.matchHeight-min.js"></script>
    
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/clip.js"></script>

    
    <script src="/js/toastr.min.js"></script>

    
    <script src="/node_modules/highlight.js/lib/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="">
    

<nav class="navbar navbar-default navbar-inverse navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
      <svg width=150 height=auto id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145"><defs><style>.cls-1{fill:#e00;}.cls-2{fill:#fff;}</style></defs><path class="cls-1" d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/><path d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/><path class="cls-2" d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/></svg>
      </a>
    </div>
    <div class="collapse navbar-collapse navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
          
            <li>
              <a href="/">Home</a>
            </li>
          
        
          
            <li>
              <a href="/about/">About</a>
            </li>
          
        
          
            <li>
              <a href="/contact/">Contact</a>
            </li>
          
        
          
            <li>
              <a href="https://www.redhat.com/en/events">Events</a>
            </li>
          
        
          
            <li>
              <a href="/jr-sa/">Junior SA Program</a>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Workshops <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/agile_integrations_ci/">Agile Integrations Workshop - Citizen Integrator</a>
                  </li>
                
                  <li>
                    <a href="/workshops/agile_integrations_dev/">Agile Integrations Workshop - Developer</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_automation/">Ansible Automation Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_tower_azure/">Ansible Tower Workshop on Azure</a>
                  </li>
                
                  <li>
                    <a href="/workshops/cloudforms41/">CloudForms Workshops</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_containers/">Container Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_101/">Containers 101 Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/secure_software_factory/">DevSecOps Workshop - Secure Software Factory</a>
                  </li>
                
                  <li>
                    <a href="/workshops/example/">Example Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/jdv_dev/">JBoss Data Virtualization Development</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_the_hard_way/">Linux Containers the Hard Way</a>
                  </li>
                
                  <li>
                    <a href="/workshops/strangling_the_monolith/">Microservices Workshop - Strangling the Monolith</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_101_dcmetromap/">OpenShift 101 - DC Metro Map Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_4_101/">OpenShift 4 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_openshift/">OpenShift Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_service_mesh/">OpenShift Service Mesh</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhel_8/">Red Hat Enterprise Linux 8</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhosp_101/">Red Hat OpenStack Platform 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/selinux_policy/">SELinux Policy Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/source_to_image/">Source to Image</a>
                  </li>
                
              </ul>
            </li>
          
        
      </ul>
    </div>
  </div>
</nav>



<div class="jumbotron jumbotron-page text-center">
  <h1>Lab 8 - CI / CD Pipeline</h1>
</div>

<div class="container">
  <div class="row">
    <p class="text-center">
      
      <a href="http://redhatgov.io/workshops/openshift_4_101">Return to Workshop</a>
    </p>
    
    







<nav>
  <ul class="pager">
    
      <li class="previous">
        <a href="http://redhatgov.io/workshops/openshift_4_101/lab7-labels/">&larr; Previous: Lab 7 - Labels</a>
      </li>
    
    
      <li class="next">
        <a href="http://redhatgov.io/workshops/openshift_4_101/lab9-bluegreen/">Next: Lab 9 - Blue | Green Deployment &rarr;</a>
      </li>
    
  </ul>
</nav>


    

<h1 id="ci-cd-defined">CI/CD Defined</h1>

<p>In modern software projects many teams utilize the concept of Continuous Integration (CI) and Continuous Delivery (CD). By setting up a tool chain that continuously builds, tests, and stages software releases, a team can ensure that their product can be reliably released at any time. OpenShift can be an enabler in the creation and management of this tool chain.</p>

<p>In this lab we walk through creating a simple example of a CI/CD <a href="https://jenkins.io/doc/book/pipeline/">pipeline</a> utilizing Jenkins, all running on top of OpenShift! The Jenkins job will trigger OpenShift to build and deploy a test version of the application, validate that the deployment works, and then tag the test version into production.</p>

<h2 id="create-a-new-project">Create a new project</h2>

<p>Create a new project named “cicd-<span class="userid">YOUR#</span>
”.</p>

<div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapseac29c26e94dfd9555c442d68e87c55d0" class="collapsed">
      
        CLI Steps
      </a>
    </h4>
  </div>
  
  <div id="collapseac29c26e94dfd9555c442d68e87c55d0" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <h2 id="create-the-project-cicd-span-class-userid-your-span">Create the project cicd-<span class="userid">YOUR#</span></h2>

<p><code>
$ oc new-project cicd-<span class="userid">YOUR#</span></p>

<p></code></p>

    </div>
  </div>
</div>



<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse05143463be645b296e3ec433e4c9f2ed" class="collapsed">
      
        Web Console Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse05143463be645b296e3ec433e4c9f2ed" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
Switch modes to 
<img src="../images/ocp-administrator-mode.png" width="257">
</blockquote>

<p><img src="../images/ocp-lab-cicd-new-project-landing.png" width="300"><br/></p>

<blockquote>
click "Create Project".
</blockquote>

<p><img src="../images/ocp-lab-cicd-new-project.png" width="400"><br/></p>

<p><blockquote>
Fill in the Name and Display Name of the project as &quot;cicd-<span class="userid">YOUR#</span>
&quot; and click &quot;Create&quot;
</blockquote>
<img src="../images/ocp-lab-cicd-new-project-detail.png" width="500"><br/></p>

    </div>
  </div>
</div>



</div>


<h2 id="instantiate-a-jenkins-server-in-your-project">Instantiate a Jenkins server in your project</h2>

<div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse0f13e2227d97f198cf50ed49322c5a12" class="collapsed">
      
        CLI Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse0f13e2227d97f198cf50ed49322c5a12" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <pre><code class="language-bash">$ oc new-app jenkins-ephemeral
</code></pre>

    </div>
  </div>
</div>



<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse0c48c6f66ab1c0d69bf58047b69a351f" class="collapsed">
      
        Web Console Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse0c48c6f66ab1c0d69bf58047b69a351f" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
In "Developer" mode, click "+Add"
</blockquote>

<p><img src="../images/ocp-developer-add.png" width="300"><br/></p>

<blockquote>
Select the "From Catalog" button, and filter on "Jenkins (Ephemeral)". Then select "Jenkins (Ephemeral)".
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-instantiate.png" width="900"><br/></p>

<p><img src="../images/ocp-lab-cicd-jenkins-instantiate1.png" width="900"><br/></p>

<blockquote>
Click
<img src="../images/ocp-instantiate-template-button.png" width="165"><br/>
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-instantiate2.png" width="900"><br/></p>

<blockquote>
Select the Project cicd-<span class="userid">YOUR#</span>
 from "Namespace"
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-instantiate3.png" width="900"><br/></p>

<blockquote>
Scroll down to the bottom, and click 
<img src="../images/ocp-create-button.png" width="75">
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-instantiate4.png" width="900"><br/></p>

    </div>
  </div>
</div>



</div>


<h2 id="create-a-sample-application-configuration">Create a sample application configuration</h2>

<div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapsead7a24e40a54b130b3ba65df14bbdd51" class="collapsed">
      
        CLI Steps
      </a>
    </h4>
  </div>
  
  <div id="collapsead7a24e40a54b130b3ba65df14bbdd51" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
<p>Let's download a tempate for a sample application, so that we can integrate it into our pipeline</p>
</blockquote>

<pre><code class="language-bash">$ wget https://raw.githubusercontent.com/openshift/origin/master/examples/jenkins/application-template.json 
</code></pre>

<blockquote>
<p>Next, let's update the template to not use an deprecated container, as it's base. We'll use Red Hat's Universal Base Image as the platform, instead:</p>
</blockquote>

<pre><code class="language-bash">$ sed 's/nodejs-010-centos7/nodejs-10/g' application-template.json &gt; NEW-Template.json
</code></pre>

<blockquote>
<p>And last, we'll instantiate the template.</p>
</blockquote>

<pre><code class="language-bash">$ oc create -f NEW-Template.json
</code></pre>

    </div>
  </div>
</div>



<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse137133fbb22b8a2d6c894bfdb014d1a5" class="collapsed">
      
        Web Console Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse137133fbb22b8a2d6c894bfdb014d1a5" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
Click "Home" and "Search"
</blockquote>

<p><img src="../images/ocp-lab-cicd-app-search.png" width="900"><br/></p>

<blockquote>
From the "Select Resource" (which defaults to Service) dropdown menu, select "Template"
</blockquote>

<p><img src="../images/ocp-lab-cicd-app-search-template.png" width="900"><br/></p>

<blockquote>
Click "..." and select "Edit Template"
</blockquote>

<p><img src="../images/ocp-lab-cicd-app-resources-edit.png" width="700"><br/></p>

<blockquote>
Find and replace "nodejs-010-centos7" with "nodejs-10"
</blockquote>

<p><img src="../images/ocp-lab-cicd-app-edit-yaml-template.png" width="800"><br/></p>

<blockquote>
Click "Save"
</blockquote>

    </div>
  </div>
</div>



</div>


<h2 id="with-either-editing-method-please-make-sure-that-your-template-looks-like-this-when-it-is-complete">With either editing method, please make sure that your template looks like this, when it is complete:</h2>

<div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse7ebea01a4c920a22403a0eecb1ef5b60" class="collapsed">
      
        Edited Template
      </a>
    </h4>
  </div>
  
  <div id="collapse7ebea01a4c920a22403a0eecb1ef5b60" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
<p>Your timestamp and uid will vary</p>
</blockquote>

<pre><code class="language-bash">{
  &quot;kind&quot;: &quot;Template&quot;,
  &quot;apiVersion&quot;: &quot;v1&quot;,
  &quot;metadata&quot;: {
    &quot;name&quot;: &quot;nodejs-helloworld-sample&quot;,
    &quot;annotations&quot;: {
      &quot;description&quot;: &quot;This example shows how to create a simple nodejs application in openshift origin v3&quot;,
      &quot;iconClass&quot;: &quot;icon-nodejs&quot;,
      &quot;tags&quot;: &quot;instant-app,nodejs&quot;
    }
  },
  &quot;objects&quot;: [
    {
      &quot;kind&quot;: &quot;Service&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;frontend-prod&quot;
      },
      &quot;spec&quot;: {
        &quot;ports&quot;: [
          {
            &quot;name&quot;: &quot;web&quot;,
            &quot;protocol&quot;: &quot;TCP&quot;,
            &quot;port&quot;: 8080,
            &quot;targetPort&quot;: 8080,
            &quot;nodePort&quot;: 0
          }
        ],
        &quot;selector&quot;: {
          &quot;name&quot;: &quot;frontend-prod&quot;
        },
        &quot;type&quot;: &quot;ClusterIP&quot;,
        &quot;sessionAffinity&quot;: &quot;None&quot;
      },
      &quot;status&quot;: {
        &quot;loadBalancer&quot;: {}
      }
    },
    {
      &quot;kind&quot;: &quot;Route&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;frontend&quot;
      },
      &quot;spec&quot;: {
        &quot;to&quot;: {
          &quot;kind&quot;: &quot;Service&quot;,
          &quot;name&quot;: &quot;frontend&quot;
        },
        &quot;tls&quot;: {
          &quot;termination&quot;: &quot;edge&quot;
        }
      }
    },
    {
      &quot;kind&quot;: &quot;DeploymentConfig&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;frontend-prod&quot;
      },
      &quot;spec&quot;: {
        &quot;strategy&quot;: {
          &quot;type&quot;: &quot;Rolling&quot;,
          &quot;rollingParams&quot;: {
            &quot;updatePeriodSeconds&quot;: 1,
            &quot;intervalSeconds&quot;: 1,
            &quot;timeoutSeconds&quot;: 120
          }
        },
        &quot;triggers&quot;: [
          {
            &quot;type&quot;: &quot;ImageChange&quot;,
            &quot;imageChangeParams&quot;: {
              &quot;automatic&quot;: true,
              &quot;containerNames&quot;: [
                &quot;nodejs-helloworld&quot;
              ],
              &quot;from&quot;: {
                &quot;kind&quot;: &quot;ImageStreamTag&quot;,
                &quot;name&quot;: &quot;origin-nodejs-sample:prod&quot;
              }
            }
          },
          {
            &quot;type&quot;: &quot;ConfigChange&quot;
          }
        ],
        &quot;replicas&quot;: 1,
        &quot;selector&quot;: {
          &quot;name&quot;:&quot;frontend-prod&quot;
        },
        &quot;template&quot;: {
          &quot;metadata&quot;: {
            &quot;labels&quot;: {
              &quot;name&quot;: &quot;frontend-prod&quot;
            }
          },
          &quot;spec&quot;: {
            &quot;containers&quot;: [
              {
                &quot;name&quot;: &quot;nodejs-helloworld&quot;,
                &quot;image&quot;: &quot; &quot;,
                &quot;ports&quot;: [
                  {
                    &quot;containerPort&quot;: 8080,
                    &quot;protocol&quot;: &quot;TCP&quot;
                  }
                ],
                &quot;resources&quot;: {
                  &quot;limits&quot;: {
                    &quot;memory&quot;: &quot;${MEMORY_LIMIT}&quot;
                  }
                },
                &quot;terminationMessagePath&quot;: &quot;/dev/termination-log&quot;,
                &quot;imagePullPolicy&quot;: &quot;IfNotPresent&quot;,
                &quot;securityContext&quot;: {
                  &quot;capabilities&quot;: {},
                  &quot;privileged&quot;: false
                }
              }
            ],
            &quot;restartPolicy&quot;: &quot;Always&quot;,
            &quot;dnsPolicy&quot;: &quot;ClusterFirst&quot;
          }
        }
      }
    },
    {
      &quot;kind&quot;: &quot;Service&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;frontend&quot;
      },
      &quot;spec&quot;: {
        &quot;ports&quot;: [
          {
            &quot;name&quot;: &quot;web&quot;,
            &quot;protocol&quot;: &quot;TCP&quot;,
            &quot;port&quot;: 8080,
            &quot;targetPort&quot;: 8080,
            &quot;nodePort&quot;: 0
          }
        ],
        &quot;selector&quot;: {
          &quot;name&quot;: &quot;frontend&quot;
        },
        &quot;type&quot;: &quot;ClusterIP&quot;,
        &quot;sessionAffinity&quot;: &quot;None&quot;
      }
    },
    {
      &quot;kind&quot;: &quot;ImageStream&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;origin-nodejs-sample&quot;
      }
    },
    {
      &quot;kind&quot;: &quot;ImageStream&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;origin-nodejs-sample2&quot;
      }
    },
    {
      &quot;kind&quot;: &quot;ImageStream&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;origin-nodejs-sample3&quot;
      }
    },
    {
      &quot;kind&quot;: &quot;ImageStream&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;nodejs-10&quot;
      },
      &quot;spec&quot;: {
        &quot;dockerImageRepository&quot;: &quot;${NAMESPACE}/nodejs-10&quot;
      }
    },
    {
      &quot;kind&quot;: &quot;BuildConfig&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;frontend&quot;,
        &quot;labels&quot;: {
          &quot;name&quot;: &quot;nodejs-sample-build&quot;
        }
      },
      &quot;spec&quot;: {
        &quot;triggers&quot;: [
          {
            &quot;type&quot;: &quot;GitHub&quot;,
            &quot;github&quot;: {
              &quot;secret&quot;: &quot;secret101&quot;
            }
          },
          {
            &quot;type&quot;: &quot;Generic&quot;,
            &quot;generic&quot;: {
              &quot;secret&quot;: &quot;secret101&quot;
            }
          }
        ],
        &quot;source&quot;: {
          &quot;type&quot;: &quot;Git&quot;,
          &quot;git&quot;: {
            &quot;uri&quot;: &quot;https://github.com/openshift/nodejs-ex.git&quot;
          }
        },
        &quot;strategy&quot;: {
          &quot;type&quot;: &quot;Source&quot;,
          &quot;sourceStrategy&quot;: {
            &quot;from&quot;: {
              &quot;kind&quot;: &quot;ImageStreamTag&quot;,
              &quot;name&quot;: &quot;nodejs-10:latest&quot;
            }
          }
        },
        &quot;output&quot;: {
          &quot;to&quot;: {
            &quot;kind&quot;: &quot;ImageStreamTag&quot;,
            &quot;name&quot;: &quot;origin-nodejs-sample:latest&quot;
          }
        },
        &quot;resources&quot;: {}
      }
    },
    {
      &quot;kind&quot;: &quot;DeploymentConfig&quot;,
      &quot;apiVersion&quot;: &quot;v1&quot;,
      &quot;metadata&quot;: {
        &quot;name&quot;: &quot;frontend&quot;
      },
      &quot;spec&quot;: {
        &quot;strategy&quot;: {
          &quot;type&quot;: &quot;Rolling&quot;,
          &quot;rollingParams&quot;: {
            &quot;updatePeriodSeconds&quot;: 1,
            &quot;intervalSeconds&quot;: 1,
            &quot;timeoutSeconds&quot;: 120
          }
        },
        &quot;triggers&quot;: [
          {
            &quot;type&quot;: &quot;ImageChange&quot;,
            &quot;imageChangeParams&quot;: {
              &quot;automatic&quot;: false,
              &quot;containerNames&quot;: [
                &quot;nodejs-helloworld&quot;
              ],
              &quot;from&quot;: {
                &quot;kind&quot;: &quot;ImageStreamTag&quot;,
                &quot;name&quot;: &quot;origin-nodejs-sample:latest&quot;
              }
            }
          },
          {
            &quot;type&quot;: &quot;ConfigChange&quot;
          }
        ],
        &quot;replicas&quot;: 1,
        &quot;selector&quot;: {
          &quot;name&quot;:&quot;frontend&quot;
          },
        &quot;template&quot;: {
          &quot;metadata&quot;: {
            &quot;labels&quot;: {
              &quot;name&quot;: &quot;frontend&quot;
            }
          },
          &quot;spec&quot;: {
            &quot;containers&quot;: [
              {
                &quot;name&quot;: &quot;nodejs-helloworld&quot;,
                &quot;image&quot;: &quot; &quot;,
                &quot;ports&quot;: [
                  {
                    &quot;containerPort&quot;: 8080,
                    &quot;protocol&quot;: &quot;TCP&quot;
                  }
                ],
                &quot;resources&quot;: {
                  &quot;limits&quot;: {
                    &quot;memory&quot;: &quot;${MEMORY_LIMIT}&quot;
                  }
                },
                &quot;terminationMessagePath&quot;: &quot;/dev/termination-log&quot;,
                &quot;imagePullPolicy&quot;: &quot;IfNotPresent&quot;,
                &quot;securityContext&quot;: {
                  &quot;capabilities&quot;: {},
                  &quot;privileged&quot;: false
                }
              }
            ],
            &quot;restartPolicy&quot;: &quot;Always&quot;,
            &quot;dnsPolicy&quot;: &quot;ClusterFirst&quot;
          }
        }
      }
    }
  ],
  &quot;parameters&quot;: [
    {
      &quot;name&quot;: &quot;MEMORY_LIMIT&quot;,
      &quot;displayName&quot;: &quot;Memory Limit&quot;,
      &quot;description&quot;: &quot;Maximum amount of memory the container can use.&quot;,
      &quot;value&quot;: &quot;512Mi&quot;
    },
    {
      &quot;name&quot;: &quot;NAMESPACE&quot;,
      &quot;displayName&quot;: &quot;Namespace&quot;,
      &quot;description&quot;: &quot;The OpenShift Namespace where the ImageStream resides.&quot;,
      &quot;value&quot;: &quot;openshift&quot;
    },
   {
      &quot;name&quot;: &quot;ADMIN_USERNAME&quot;,
      &quot;displayName&quot;: &quot;Administrator Username&quot;,
      &quot;description&quot;: &quot;Username for the administrator of this application.&quot;,
      &quot;generate&quot;: &quot;expression&quot;,
      &quot;from&quot;: &quot;admin[A-Z0-9]{3}&quot;
    },
    {
      &quot;name&quot;: &quot;ADMIN_PASSWORD&quot;,
      &quot;displayName&quot;: &quot;Administrator Password&quot;,
      &quot;description&quot;: &quot;Password for the administrator of this application.&quot;,
      &quot;generate&quot;: &quot;expression&quot;,
      &quot;from&quot;: &quot;[a-zA-Z0-9]{8}&quot;
    }
  ],
  &quot;labels&quot;: {
    &quot;template&quot;: &quot;application-template-stibuild&quot;
  }
}
</code></pre>

    </div>
  </div>
</div>



</div>


<h2 id="create-a-sample-application-from-template">Create a sample application from template</h2>

<blockquote>
<p>Use the &quot;oc process&quot; command to create a simple nodejs application from the template file:</p>
</blockquote>

<pre><code class="language-bash">$ oc process nodejs-helloworld-sample -p NAMESPACE=registry.access.redhat.com/ubi7 | oc create -f -
</code></pre>

<blockquote>
<p>You will see the followig:</p>
</blockquote>

<pre><code class="language-bash">service/frontend-prod created
route.route.openshift.io/frontend created
deploymentconfig.apps.openshift.io/frontend-prod created
service/frontend created
imagestream.image.openshift.io/origin-nodejs-sample created
imagestream.image.openshift.io/origin-nodejs-sample2 created
imagestream.image.openshift.io/origin-nodejs-sample3 created
imagestream.image.openshift.io/nodejs-10 created
buildconfig.build.openshift.io/frontend created
deploymentconfig.apps.openshift.io/frontend created
</code></pre>

<blockquote>
<p>Click on &quot;Workloads&quot; and then &quot;Deployment Configs&quot;, within the OpenShift console, to display the sample application configuration</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-app-create.png" width="900"><br/></p>

<h2 id="confirm-you-can-access-jenkins">Confirm you can access Jenkins</h2>

<p><div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapsee57ecfe46f240217b3d3f3c73dbd3891" class="collapsed">
      
        CLI Steps
      </a>
    </h4>
  </div>
  
  <div id="collapsee57ecfe46f240217b3d3f3c73dbd3891" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
<i class="fa fa-terminal"></i> Get the route to the Jenkins server. Your HOST/PORT values will differ
from the example below.
</blockquote>

<pre><code class="language-bash">$ oc get route
NAME       HOST/PORT                            PATH      SERVICES   PORT      TERMINATION     WILDCARD
frontend   frontend-cicd.192.168.42.27.xip.io             frontend   &lt;all&gt;     edge            None
jenkins    jenkins-cicd.192.168.42.27.xip.io              jenkins    &lt;all&gt;     edge/Redirect   None
</code></pre>

<p>Use Jenkins HOST/PORT to access through web browser</p>

    </div>
  </div>
</div>



<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse0116145d51083864f2f204b94db6c8e5" class="collapsed">
      
        Web Console Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse0116145d51083864f2f204b94db6c8e5" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
In "Developer" mode, under "Topology", click the arrow, in the upper right corner of the "jenkins" icon
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-overview.png" width="500"><br/></p>

    </div>
  </div>
</div>



</div>
</p>

<blockquote>
<p>Select &quot;Login with OpenShift&quot; from Jenkins login page</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-login-1.png" width="400">
</br></p>

<p>The OpenShift login page is displayed in a new browser tab.</p>

<blockquote>
<p>Login with your OpenShift user name and password</p>
</blockquote>

<p><img src="../images/ocp-login.png" width="600">
<br/></p>

<p>Once logged in, click the [Allow selected permissions] button and you should see the Jenkins dashboard.</p>

<h2 id="create-a-jenkins-pipeline-using-openshift">Create a Jenkins pipeline using OpenShift</h2>

<p>We will be creating the following very simple (4) stage Jenkins pipeline.</p>

<ol>
<li>Build the application from source.</li>
<li>Deploy the test version of the application.</li>
<li>Submit for approval, then tag the image for production, otherwise abort.</li>
<li>Scale the application.</li>
</ol>

<p>The first step is to create a build configuration that is based on a Jenkins pipeline strategy. The pipeline is written
in the GROOVY language using a Jenkins file format.</p>

<blockquote>
<p>Use the OpenShift CLI or Web Console to create an OpenShift build configuration object.</p>
</blockquote>

<div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse28146371758450c50306346faeee4792" class="collapsed">
      
        CLI Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse28146371758450c50306346faeee4792" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <p>Copy and paste the following into bash.</p>

<pre><code class="language-bash">oc create -f - &lt;&lt;EOF
kind: &quot;BuildConfig&quot;
apiVersion: &quot;v1&quot;
metadata:
  name: &quot;pipeline&quot;
spec:
  strategy:
    jenkinsPipelineStrategy:
      jenkinsfile: |-
        pipeline {
          agent any
          stages {
            stage('buildFrontEnd') {
              steps {
                script {
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.selector(&quot;bc&quot;, &quot;frontend&quot;).startBuild(&quot;--wait=true&quot;, &quot;--follow&quot;)
                    }
                  }
                }
              }
            }
            stage('deployFrontEnd') {
              steps {
                script {
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.selector(&quot;dc&quot;, &quot;frontend&quot;).rollout().latest()
                    }
                  }
                }
              }
            }
            stage('promoteToProd') {
              steps {
                script {
                  timeout(time: 15, unit: 'MINUTES') {
                    input message: &quot;Promote to PROD?&quot;, ok: &quot;Promote&quot;
                  }
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.tag(&quot;origin-nodejs-sample:latest&quot;, &quot;origin-nodejs-sample:prod&quot;)
                    }
                  }
                }
              }
            }
            stage('scaleUp') {
              steps {
                script {
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.selector(&quot;dc&quot;, &quot;frontend-prod&quot;).scale(&quot;--replicas=2&quot;)
                    }
                  }
                }
              }
            }
          }
        }
EOF
</code></pre>

<p>Expected output:</p>

<pre><code class="language-bash">buildconfig.build.openshift.io/pipeline created
</code></pre>

    </div>
  </div>
</div>



<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapsec5a3cc0827b233dcb74c5b91bfb198fc" class="collapsed">
      
        Web Console Steps
      </a>
    </h4>
  </div>
  
  <div id="collapsec5a3cc0827b233dcb74c5b91bfb198fc" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
<p>Click on &quot;Build&quot; and then &quot;Create Build Config&quot;</p>

<p>Use the following OpenShift build configuration to create the pipeline.</p>
</blockquote>

<pre><code class="language-bash">kind: &quot;BuildConfig&quot;
apiVersion: &quot;build.openshift.io/v1&quot;
metadata:
  name: &quot;pipeline&quot;
spec:
  strategy:
    jenkinsPipelineStrategy:
      jenkinsfile: |-
        pipeline {
          agent any
          stages {
            stage('buildFrontEnd') {
              steps {
                script {
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.selector(&quot;bc&quot;, &quot;frontend&quot;).startBuild(&quot;--wait=true&quot;, &quot;--follow&quot;)
                    }
                  }
                }
              }
            }
            stage('deployFrontEnd') {
              steps {
                script {
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.selector(&quot;dc&quot;, &quot;frontend&quot;).rollout().latest()
                    }
                  }
                }
              }
            }
            stage('promoteToProd') {
              steps {
                script {
                  timeout(time: 15, unit: 'MINUTES') {
                    input message: &quot;Promote to PROD?&quot;, ok: &quot;Promote&quot;
                  }
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.tag(&quot;origin-nodejs-sample:latest&quot;, &quot;origin-nodejs-sample:prod&quot;)
                    }
                  }
                }
              }
            }
            stage('scaleUp') {
              steps {
                script {
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.selector(&quot;dc&quot;, &quot;frontend-prod&quot;).scale(&quot;--replicas=2&quot;)
                    }
                  }
                }
              }
            }
          }
        }
</code></pre>

<blockquote>
<p>Choose <em>+Add</em> -&gt; <em>YAML</em>, from <em>Developer</em> mode</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-import-yaml.png" width="900"></p>

<blockquote>
<p>Then copy and paste the above build configuration definition and choose &quot;Create&quot;.</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-import-yaml-dialog.png" width="900"></p>

    </div>
  </div>
</div>



</div>


<h2 id="start-the-pipeline">Start the pipeline</h2>

<blockquote>
<p>Using the OpenShift Web Console, in &quot;Administrator&quot; mode, choose <em>Builds</em> -&gt; <em>Build Configs</em>, and then click on &quot;pipeline&quot;</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-start-pipeline.png" width="900"></p>

<blockquote>
<p>From the &quot;Actions&quot; menu, choose &quot;Start Build&quot;</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-pipeline-actions-start_build.png" width="200"></p>

<p>When the pipeline starts, OpenShift uploads the pipeline to the Jenkins server for execution. As it runs, the various stages trigger OpenShift to build and deploy the frontend microservice. After a Jenkins user approves the frontend deployment, Jenkins triggers OpenShift to tag the image stream with the &quot;:prod&quot; tag then scales the frontend-prod deployment for (2) replicas.</p>

<p>The Jenkins dashboard should indicate that a new build is executing.</p>

<p><img src="../images/ocp-lab-cicd-jenkins-build-exec-status.png"></p>

<p>Back in the OpenShift Web Console, watch the pipeline execute. Once the &quot;deployFrontEnd&quot; stage completes, you should be able to visit the route for the frontend service in a web browser.</p>

<p><img src="../images/ocp-lab-cicd-pipeline-input.png"></p>

<blockquote>
<p>Click on &quot;Input Required&quot; and you should get redirected to the Jenkins Web Console</p>

<p>Click on &quot;Paused for Input&quot;, in the left-side menu</p>
</blockquote>

<p><img src="../images/oc-lab-cicd-jenkins-pausedForInput.png"></p>

<blockquote>
<p>You can now approve the deployment to the PROD environment</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-promote.png"></p>

<blockquote>
<p>Now return to the OpenShift Web Console and watch the pipeline finish.</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-pipeline-stages.png"></p>

<blockquote>
<p>Confirm the <em>frontend-prod</em> has deployed 2 pods.</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-dc-frontend-prod.png" width="900"></p>

<blockquote>
<p>Now <em>create a secure route</em> with TLS edge termination the <em>frontend-prod</em> service so the application can be visited.</p>

<p>Go to <em>Networking</em> -&gt; <em>Routes</em>, and click
<img src="../images/ocp-create-route-button.png" width="100"></p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-routes.png" width="900"></p>

<blockquote>
<p>Fill out the form, as shown, and then click
<img src="../images/ocp-create-button.png" width="100"></p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-route-tls.png" width="900"></p>

<h2 id="confirm-both-the-test-and-production-services-are-available">Confirm both the test and production services are available</h2>

<blockquote>
<p>Browse to both services</p>
</blockquote>

<p><div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse148ee6f706468d9abd17322cf0719de7" class="collapsed">
      
        CLI Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse148ee6f706468d9abd17322cf0719de7" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <p>Use the <code>oc get routes</code> command to get the HOST/PORT (URLs) needed to access the frontend and frontend-prod services. Your HOST/PORT values will differ
from the example below.</p>

<pre><code class="language-bash">$ oc get routes
NAME            HOST/PORT                                          PATH   SERVICES        PORT    TERMIN
ATION     WILDCARD
frontend        frontend-cicd-1.apps.alexocp43.redhatgov.io               frontend        &lt;all&gt;   edge
          None
frontend-prod   frontend-prod-cicd-1.apps.alexocp43.redhatgov.io          frontend-prod   web     edge/R
edirect   None
jenkins         jenkins-cicd-1.apps.alexocp43.redhatgov.io                jenkins         &lt;all&gt;   edge/R
edirect   None
</code></pre>

<p>Use a web browser to visit the HOST/PORT (URLs) for the frontend and frontend-prod services. Don't forget the <code>https://</code> prefix.</p>

<p>Alternately, you can use <em>curl</em>, right from your terminal</p>

<pre><code class="language-bash">$ curl -k https://frontend-prod-cicd-1.apps.alexocp43.redhatgov.io 2&gt;/dev/null | head -6
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot;&gt;
  &lt;title&gt;Welcome to OpenShift&lt;/title&gt;
</code></pre>

    </div>
  </div>
</div>



<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse34fd17cf446f05802d1a90df2ca7788f" class="collapsed">
      
        Web Console Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse34fd17cf446f05802d1a90df2ca7788f" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <blockquote>
In "Developer" mode, select the "cicd-1" project, and click on "Topology"
</blockquote>

<p><img src="../images/ocp-lab-cicd-jenkins-app-overview.png" width="900"><br/></p>

<blockquote>
Click on the arrow, at the upper right corner of the "frontend-prod" icon, to launch the web page
<img src="../images/ocp-launch-button.png" width="50"><br/>
</blockquote>

    </div>
  </div>
</div>



</div>
</p>

<p>Service web page displayed:</p>

<p><img src="../images/ocp-lab-cicd-app-test.png"><br/></p>

<h2 id="edit-the-pipeline">Edit the pipeline.</h2>

<blockquote>
<p>Now make a change to the pipeline. For example, in the <em>scaleUp</em> stage, change the number
of replicas to 3.</p>
</blockquote>

<p>Technically speaking, a rebuild from source is not needed to scale up a deployment. We use
this simple example to illustrate how a pipeline may be edited within OpenShift.</p>

<div class="panel-group">
  


<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse69267120a1dd630532fa009303dbd4f2" class="collapsed">
      
        CLI Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse69267120a1dd630532fa009303dbd4f2" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <p>If you are comfortable using the <strong>vi</strong> editor:</p>

<pre><code class="language-bash">oc edit bc/pipeline
</code></pre>

<p>Here is an excerpt from the file, showing the necessary change:</p>

<pre><code class="language-bash">            stage('scaleUp') {
              steps {
                script {
                  openshift.withCluster() {
                    openshift.withProject() {
                      openshift.selector(&quot;dc&quot;, &quot;frontend-prod&quot;).scale(&quot;--replicas=3&quot;)
</code></pre>

    </div>
  </div>
</div>



<div class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      
      <a data-toggle="collapse" href="#collapse5c32d00d6332e981fc83f3566add305c" class="collapsed">
      
        Web Console Steps
      </a>
    </h4>
  </div>
  
  <div id="collapse5c32d00d6332e981fc83f3566add305c" class="panel-collapse collapse ">
  
    <div class="panel-body">
       <p><img src="../images/ocp-lab-cicd-pipeline-edit.png"></p>

    </div>
  </div>
</div>



</div>


<blockquote>
<p>Save your changes and run the pipeline again to confirm the <em>frontend-prod</em> deployment has
deployed 3 pods.</p>
</blockquote>

<p><img src="../images/ocp-lab-cicd-app-3-pods.png" width="900"></p>

<h1 id="summary">Summary</h1>

<p>In this lab you have very quickly and easily constructed a basic Build/Test/Deploy pipeline. Although our example was very basic it introduces you to a powerful DevOps feature of OpenShift through the leveraging of Jenkins. This can be extended to support complex real-world continuous delivery requirements. Read more about the use of Jenkins on OpenShift <a href="https://docs.openshift.com/enterprise/latest/using_images/other_images/jenkins.html">here</a> and more about Jenkins <a href="https://jenkins.io/doc">here</a>.</p>

<hr>
<h3>Workshop Details</h3>
<div class="row">
  <div class="col-lg-4 col-md-5 col-sm-12" id="workshopFooterDetails">
    <table>
      <tr>
        <td class="text-right"><b>Domain</b></td>
        <td><span class="domain"></span></td>
        <td rowspan="3">
          <img src="https://marketing-outfit-prod-images.s3-us-west-2.amazonaws.com/f5445ae0c9ddafd5b2f1836854d7416a/Logo-RedHat-Email.png" alt="Red Hat Logo" />
        </td>
      </tr>
      <tr>
        <td class="text-right"><b>Workshop</b></td>
        <td><span class="prefix"></span></td>
      </tr>
      <tr>
        <td class="text-right"><b>Student ID</b></td>
        <td><span class="userid"></span></td>
      </tr>
    </table>
  </div>
  <div class="col-lg-8 col-md-7 col-sm-12">
    <form id="footerForm" onsubmit="return false;" class="row" style="padding: 1.75rem 0 0 0;">
      <div class="form-group col-sm-6 col-md-6 col-lg-2">
        <label for="userid">Student ID</label>
        <select id="userid" name="userid" class="form-control" onchange="updateFooter(this)">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
          <option value="11">11</option>
          <option value="12">12</option>
          <option value="13">13</option>
          <option value="14">14</option>
          <option value="15">15</option>
          <option value="16">16</option>
          <option value="17">17</option>
          <option value="18">18</option>
          <option value="19">19</option>
          <option value="20">20</option>
          <option value="21">21</option>
          <option value="22">22</option>
          <option value="23">23</option>
          <option value="24">24</option>
          <option value="25">25</option>
          <option value="26">26</option>
          <option value="27">27</option>
          <option value="28">28</option>
          <option value="29">29</option>
          <option value="30">30</option>
          <option value="31">31</option>
          <option value="32">32</option>
          <option value="33">33</option>
          <option value="34">34</option>
          <option value="35">35</option>
          <option value="36">36</option>
          <option value="37">37</option>
          <option value="38">38</option>
          <option value="39">39</option>
          <option value="40">40</option>
          <option value="41">41</option>
          <option value="42">42</option>
          <option value="43">43</option>
          <option value="44">44</option>
          <option value="45">45</option>
          <option value="46">46</option>
          <option value="47">47</option>
          <option value="48">48</option>
          <option value="49">49</option>
          <option value="50">50</option>
          <option value="51">51</option>
          <option value="52">52</option>
          <option value="53">53</option>
          <option value="54">54</option>
          <option value="55">55</option>
          <option value="56">56</option>
          <option value="57">57</option>
          <option value="58">58</option>
          <option value="59">59</option>
          <option value="60">60</option>
          <option value="61">61</option>
          <option value="62">62</option>
          <option value="63">63</option>
          <option value="64">64</option>
          <option value="65">65</option>
          <option value="66">66</option>
          <option value="67">67</option>
          <option value="68">68</option>
          <option value="69">69</option>
          <option value="70">70</option>
          <option value="71">71</option>
          <option value="72">72</option>
          <option value="73">73</option>
          <option value="74">74</option>
          <option value="75">75</option>
          <option value="76">76</option>
          <option value="77">77</option>
          <option value="78">78</option>
          <option value="79">79</option>
          <option value="80">80</option>
          <option value="81">81</option>
          <option value="82">82</option>
          <option value="83">83</option>
          <option value="84">84</option>
          <option value="85">85</option>
          <option value="86">86</option>
          <option value="87">87</option>
          <option value="88">88</option>
          <option value="89">89</option>
          <option value="90">90</option>
          <option value="91">91</option>
          <option value="92">92</option>
          <option value="93">93</option>
          <option value="94">94</option>
          <option value="95">95</option>
          <option value="96">96</option>
          <option value="97">97</option>
          <option value="98">98</option>
          <option value="99">99</option>
        </select>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-4">
        <label for="domain">Domain</label>
        <select id="domain" name="domain" class="form-control" onchange="updateFooter(this)">
          <option value="redhatgov.io">redhatgov.io</option>
          <option value="az.redhatgov.io">az.redhatgov.io</option>
          <option value="redhat-fierce.io">redhat-fierce.io</option>
          <option value="fiercesw.network">fiercesw.network</option>
          <option value="rhtps.io">rhtps.io</option>
          <option value="openshiftworkshop.com">openshiftworkshop.com</option>
          <option value="redhatpsmwsa.com">redhatpsmwsa.com</option>          
          <option value="open.redhat.com">open.redhat.com</option>          
        </select>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-3">
        <label for="prefix">Workshop</label>
        <input id="prefix" name="prefix" type="text" size="16" class="form-control" placeholder="example"/>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-3">
        <button type="submit" class="btn btn-primary form-control" style="margin-bottom:1rem;">Enter</button>
        <button type="reset" class="btn btn-default form-control">Default</button>
      </div>
    </form>
  </div>
</div>

<hr>

<script type="text/javascript" src="/node_modules/js-cookie/src/js.cookie.js"></script>
<script type="text/javascript">
<!--
  
  var Cookies2 = Cookies.noConflict();

  var cookiePathArr = cleanArray(window.location.pathname.split('/'));
  var cookiePath = '/' + cookiePathArr[0] + '/' + cookiePathArr[1] + '/';

  function cleanArray(actual) {
    var newArray = new Array();
    for (var i = 0; i < actual.length; i++) {
      if (actual[i]) {
        newArray.push(actual[i]);
      }
    }
    return newArray;
  }
  function replaceClassText() {
    jQuery("span.domain").html(Cookies2.get("domain"));
    jQuery("span.userid").html(Cookies2.get("userid"));
    jQuery("span.prefix").html(Cookies2.get("prefix"));
  }
  function pageLoadWorkshopFooterTest() {
    
    if (Cookies2.get("domain") === undefined) {
      resetWorkshopFooter();
    }
    else {
      replaceClassText();
      setWorkshopFooterInputValues()
    }
  }
  function setWorkshopFooterData() {
    
    Cookies2.set("domain", jQuery("select#domain").val(), { path: cookiePath, expires: 7 } );
    Cookies2.set("prefix", jQuery("input#prefix").val(), { path: cookiePath, expires: 7 } );
    Cookies2.set("userid", jQuery("select#userid").val(), { path: cookiePath, expires: 7 } );
    replaceClassText();
  }
  function setWorkshopFooterInputValues() {
    jQuery("select#domain").val(Cookies2.get("domain"));
    jQuery("input#prefix").val(Cookies2.get("prefix"));
    jQuery("select#userid").val(Cookies2.get("userid"));
  }
  function resetWorkshopFooter() {
    
    jQuery("select#domain, select#userid").prop("selectedIndex", 0);
    jQuery("input#prefix").val(jQuery("input#prefix").attr('placeholder'));
    
    Cookies2.set("domain", jQuery("select#domain option").first().val(), { path: cookiePath, expires: 7 } ); 
    Cookies2.set("userid", jQuery("select#userid option").first().val(), { path: cookiePath, expires: 7 } ); 
    Cookies2.set("prefix", jQuery("input#prefix").val(), { path: cookiePath, expires: 7 } );
    
    
    replaceClassText();
  }




  function updateFooter(e){
    fieldName = '';

    switch(e.id) {
      case 'userid':
        fieldName = 'User Id';
        break;
      case 'domain':
        fieldName = 'Domain';
        break;
      case 'prefix':
        fieldName = 'Workshop';
        break;
      default:
        fieldName = 'unknown';
    }
    setWorkshopFooterData();
    toastr["success"](fieldName + " set to " + e.value);
  }

  jQuery(document).ready(function() {
    pageLoadWorkshopFooterTest();


    
    var input = document.getElementById("prefix");

    
    input.addEventListener("keyup", function(event) {
      
      if (event.keyCode === 13) {
        
        event.preventDefault();
        
        
        updateFooter(input);
      }
    });


    jQuery("form#footerForm").submit(function() {
      setWorkshopFooterData();
      return false; 
    });

    jQuery("form#footerForm").bind("reset", function() {
      resetWorkshopFooter();
      return true;
    });

    return false;
  });
-->
</script>




    







<nav>
  <ul class="pager">
    
      <li class="previous">
        <a href="http://redhatgov.io/workshops/openshift_4_101/lab7-labels/">&larr; Previous: Lab 7 - Labels</a>
      </li>
    
    
      <li class="next">
        <a href="http://redhatgov.io/workshops/openshift_4_101/lab9-bluegreen/">Next: Lab 9 - Blue | Green Deployment &rarr;</a>
      </li>
    
  </ul>
</nav>


    <p class="text-center">
      
      <a href="http://redhatgov.io/workshops/openshift_4_101">Return to Workshop</a>
    </p>
  </div>
</div>

    <div id="page-footer" class="container">
      <p class="text-center">
        Copyright &copy; 2020 Red Hat, Inc.
      </p>
    </div>
    <script type="text/javascript">
      if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
      }
    </script>
  </body>
</html>

